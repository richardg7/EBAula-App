{"version":3,"sources":["../../src/addon/mod/scorm/pages/player/player.ngfactory.js.pre-build-optimizer.js","../../src/addon/mod/scorm/classes/data-model-12.ts","../../src/addon/mod/scorm/pages/player/player.ts","../../src/addon/mod/scorm/pages/player/player.module.ts","../../src/addon/mod/scorm/pages/player/player.module.ngfactory.js.pre-build-optimizer.js"],"names":["View_AddonModScormPlayerPage_1","_l","core","_v","en","$event","ad","component","openToc","button_ngfactory","button_button","config","icon","name","_ck","_hidden","View_AddonModScormPlayerPage_2","spinner_ngfactory","spinner","_paused","View_AddonModScormPlayerPage_3","iframe_ngfactory","iframe","logger","utils_iframe","dom","platform_browser","src","iframeWidth","iframeHeight","_co","scorm","popup","width","undefined","height","View_AddonModScormPlayerPage_4","translate_pipe","translate_service","transform","errorMessage","View_AddonModScormPlayerPage_0","toolbar_header","view_controller","navbar_ngfactory","navbar","app","nav_controller","back_button","platform","events","toolbar_title_ngfactory","toolbar_title","toolbar","format_text","sites","utils_text","utils","url","filepool","providers_app","providers_helper","content","split_view","text","toolbar_item","_buttons","common","ngIf","content_ngfactory","dom_controller","keyboard","loading_ngfactory","loading","hideUntil","loadSco","navigation_bar_ngfactory","navigation_bar","previous","next","action","title","showToc","loadingToc","toc","length","loaded","previousSco","nextSco","_sbPadding","statusbarPadding","_hasRefresher","data_model_12_AddonModScormDataModel12","AddonModScormDataModel12","eventsProvider","scormProvider","siteId","scoId","attempt","userData","mode","offline","this","CMI_STRING_256","CMI_STRING_4096","CMI_TIME","CMI_TIMESPAN","CMI_INTEGER","CMI_SINTEGER","CMI_DECIMAL","CMI_IDENTIFIER","CMI_FEEDBACK","CMI_INDEX","CMI_STATUS","CMI_STATUS_2","CMI_EXIT","CMI_TYPE","CMI_RESULT","NAV_EVENT","CMI_CHILDREN","CORE_CHILDREN","SCORE_CHILDREN","COMMENTS_CHILDREN","OBJECTIVES_CHILDREN","CORRECT_RESPONSES_CHILDREN","STUDENT_DATA_CHILDREN","STUDENT_PREFERENCE_CHILDREN","INTERACTIONS_CHILDREN","SCORE_RANGE","AUDIO_RANGE","SPEED_RANGE","WEIGHTING_RANGE","TEXT_RANGE","ERROR_STRINGS","0","101","201","202","203","301","401","402","403","404","405","currentUserData","def","defExtra","dataModel","initialized","providers_scorm","MODENORMAL","init","prototype","addTime","first","second","sFirst","split","sSecond","cFirst","cSecond","change","firstCents","parseInt","secondCents","cents","Math","floor","toString","secs","mins","hours","cloneObj","obj","temp","constructor","key","collectData","data","element","substr","expression","RegExp","elementModel","String","replace","mod","el","value","getEl","defaultvalue","push","sco","defaultdata","userdata","cmi._children","writeerror","cmi._version","cmi.core._children","cmi.core.student_id","cmi.core.student_name","cmi.core.lesson_location","format","cmi.core.credit","cmi.core.lesson_status","cmi.core.entry","cmi.core.score._children","cmi.core.score.raw","range","cmi.core.score.max","cmi.core.score.min","cmi.core.total_time","cmi.core.lesson_mode","cmi.core.exit","readerror","cmi.core.session_time","cmi.suspend_data","cmi.launch_data","cmi.comments","cmi.evaluation.comments._count","cmi.evaluation.comments._children","cmi.evaluation.comments.n.content","pattern","cmi.evaluation.comments.n.location","cmi.evaluation.comments.n.time","cmi.comments_from_lms","cmi.objectives._children","cmi.objectives._count","cmi.objectives.n.id","cmi.objectives.n.score._children","cmi.objectives.n.score.raw","cmi.objectives.n.score.min","cmi.objectives.n.score.max","cmi.objectives.n.status","cmi.student_data._children","cmi.student_data.mastery_score","cmi.student_data.max_time_allowed","cmi.student_data.time_limit_action","cmi.student_preference._children","cmi.student_preference.audio","cmi.student_preference.language","cmi.student_preference.speed","cmi.student_preference.text","cmi.interactions._children","cmi.interactions._count","cmi.interactions.n.id","cmi.interactions.n.objectives._count","cmi.interactions.n.objectives.n.id","cmi.interactions.n.time","cmi.interactions.n.type","cmi.interactions.n.correct_responses._count","cmi.interactions.n.correct_responses.n.pattern","cmi.interactions.n.weighting","cmi.interactions.n.student_response","cmi.interactions.n.result","cmi.interactions.n.latency","nav.event","match","counterElement","currentCounterIndex","elementDotFormat","currentN","indexOf","LMSCommit","param","timeout","clearTimeout","errorCode","result","storeData","triggerEvent","UPDATE_TOC_EVENT","LMSFinish","LAUNCH_NEXT_SCO_EVENT","LAUNCH_PREV_SCO_EVENT","auto","LMSGetDiagnostic","LMSGetErrorString","LMSGetLastError","LMSGetValue","parentModel","LMSInitialize","LMSSetValue","setEl","elementIndexes","subElement","i","elementIndex","count","concat","autocommit","setTimeout","bind","ranges","setOffline","storeTotalTime","tracks","parseFloat","MODEBROWSE","totalTime","success","saveTracksSync","GO_OFFLINE_EVENT","trigger","scormId","id","player_AddonModScormPlayerPage","AddonModScormPlayerPage","navParams","popoverCtrl","sitesProvider","syncProvider","domUtils","timeUtils","scormHelper","scormSyncProvider","get","newAttempt","organizationId","initialScoId","getCurrentSiteId","blockOperation","COMPONENT","ngOnInit","_this","displayTocInPlayer","fetchData","then","currentSco","setStartTime","Promise","resolve","catch","error","showErrorModalDefault","finally","tocObserver","on","refreshToc","launchNextObserver","launchPrevObserver","goOfflineObserver","convertAttemptToOffline","calculateNextAndPreviousSco","getPreviousScoFromToc","getNextScoFromToc","determineAttemptAndMode","attemptsData","determineAttemptToContinue","number","lastAttempt","attemptToContinue","isAttemptIncomplete","incomplete","createOfflineAttempt","online","getScormUserData","waitForSync","getAttemptCount","promises","fetchToc","all","getOrganizationToc","formatTocToArray","forEach","image","getScoStatusIcon","getScoFromToc","getFirstSco","ionViewWillUnload","window","API","getScoSrc","scormtype","tracks_1","saveTracks","logLaunchSco","event","popover","create","toc_popover","onDidDismiss","present","ev","invalidateAllScormData","timestamp","ngOnDestroy","off","unblockOperation","AddonModScormPlayerPageModule","RenderType_AddonModScormPlayerPage","encapsulation","styles","AddonModScormPlayerPageNgFactory","nav_params","popover_controller","sync","time","helper","scorm_sync","__webpack_require__","d","__webpack_exports__","AddonModScormPlayerPageModuleNgFactory","action_sheet_component_ngfactory","alert_component_ngfactory","app_root_ngfactory","loading_component_ngfactory","modal_component_ngfactory","picker_component_ngfactory","popover_component_ngfactory","select_popover_component_ngfactory","toast_component_ngfactory","context_menu_popover_ngfactory","course_picker_menu_popover_ngfactory","recaptchamodal_ngfactory","esm5_forms","translate_loader","translate_compiler","translate_parser","missing_translation_handler","translate_store","ionic_angular_module","_ngx_translate_core","directives_module","pipes_module","components_module","module_loader"],"mappings":"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","sourcesContent":["/**\n * @fileoverview This file was generated by the Angular template compiler. Do not edit.\n *\n * @suppress {suspiciousCode,uselessCode,missingProperties,missingOverride,checkTypes}\n * tslint:disable\n */ \nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../../../node_modules/ionic-angular/components/button/button.ngfactory\";\nimport * as i2 from \"ionic-angular/components/button/button\";\nimport * as i3 from \"ionic-angular/config/config\";\nimport * as i4 from \"ionic-angular/components/icon/icon\";\nimport * as i5 from \"../../../../../../node_modules/ionic-angular/components/spinner/spinner.ngfactory\";\nimport * as i6 from \"ionic-angular/components/spinner/spinner\";\nimport * as i7 from \"../../../../../components/iframe/iframe.ngfactory\";\nimport * as i8 from \"../../../../../components/iframe/iframe\";\nimport * as i9 from \"../../../../../providers/logger\";\nimport * as i10 from \"../../../../../providers/utils/iframe\";\nimport * as i11 from \"../../../../../providers/utils/dom\";\nimport * as i12 from \"@angular/platform-browser\";\nimport * as i13 from \"@ngx-translate/core/src/translate.pipe\";\nimport * as i14 from \"@ngx-translate/core/src/translate.service\";\nimport * as i15 from \"ionic-angular/components/toolbar/toolbar-header\";\nimport * as i16 from \"ionic-angular/navigation/view-controller\";\nimport * as i17 from \"../../../../../../node_modules/ionic-angular/components/toolbar/navbar.ngfactory\";\nimport * as i18 from \"ionic-angular/components/toolbar/navbar\";\nimport * as i19 from \"ionic-angular/components/app/app\";\nimport * as i20 from \"ionic-angular/navigation/nav-controller\";\nimport * as i21 from \"../../../../../directives/back-button\";\nimport * as i22 from \"ionic-angular/platform/platform\";\nimport * as i23 from \"../../../../../providers/events\";\nimport * as i24 from \"../../../../../../node_modules/ionic-angular/components/toolbar/toolbar-title.ngfactory\";\nimport * as i25 from \"ionic-angular/components/toolbar/toolbar-title\";\nimport * as i26 from \"ionic-angular/components/toolbar/toolbar\";\nimport * as i27 from \"../../../../../directives/format-text\";\nimport * as i28 from \"../../../../../providers/sites\";\nimport * as i29 from \"../../../../../providers/utils/text\";\nimport * as i30 from \"../../../../../providers/utils/utils\";\nimport * as i31 from \"../../../../../providers/utils/url\";\nimport * as i32 from \"../../../../../providers/filepool\";\nimport * as i33 from \"../../../../../providers/app\";\nimport * as i34 from \"../../../../../core/contentlinks/providers/helper\";\nimport * as i35 from \"ionic-angular/components/content/content\";\nimport * as i36 from \"../../../../../components/split-view/split-view\";\nimport * as i37 from \"ionic-angular/components/toolbar/toolbar-item\";\nimport * as i38 from \"@angular/common\";\nimport * as i39 from \"../../../../../../node_modules/ionic-angular/components/content/content.ngfactory\";\nimport * as i40 from \"ionic-angular/platform/dom-controller\";\nimport * as i41 from \"ionic-angular/platform/keyboard\";\nimport * as i42 from \"../../../../../components/loading/loading.ngfactory\";\nimport * as i43 from \"../../../../../components/loading/loading\";\nimport * as i44 from \"../../../../../components/navigation-bar/navigation-bar.ngfactory\";\nimport * as i45 from \"../../../../../components/navigation-bar/navigation-bar\";\nimport * as i46 from \"./player\";\nimport * as i47 from \"ionic-angular/navigation/nav-params\";\nimport * as i48 from \"ionic-angular/components/popover/popover-controller\";\nimport * as i49 from \"../../../../../providers/sync\";\nimport * as i50 from \"../../../../../providers/utils/time\";\nimport * as i51 from \"../../providers/scorm\";\nimport * as i52 from \"../../providers/helper\";\nimport * as i53 from \"../../providers/scorm-sync\";\nvar styles_AddonModScormPlayerPage = [];\nvar RenderType_AddonModScormPlayerPage = i0.ɵcrt({ encapsulation: 2, styles: styles_AddonModScormPlayerPage, data: {} });\nexport { RenderType_AddonModScormPlayerPage as RenderType_AddonModScormPlayerPage };\nfunction View_AddonModScormPlayerPage_1(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 5, \"button\", [[\"icon-only\", \"\"], [\"ion-button\", \"\"]], null, [[null, \"click\"]], function (_v, en, $event) { var ad = true; var _co = _v.component; if ((\"click\" === en)) {\n        var pd_0 = (_co.openToc($event) !== false);\n        ad = (pd_0 && ad);\n    } return ad; }, i1.View_Button_0, i1.RenderType_Button)), i0.ɵdid(1, 1097728, [[1, 4]], 0, i2.Button, [[8, \"\"], i3.Config, i0.ElementRef, i0.Renderer], null, null), (_l()(), i0.ɵted(-1, 0, [\"\\n                \"])), (_l()(), i0.ɵeld(3, 0, null, 0, 1, \"ion-icon\", [[\"name\", \"bookmark\"], [\"role\", \"img\"]], [[2, \"hide\", null]], null, null, null, null)), i0.ɵdid(4, 147456, null, 0, i4.Icon, [i3.Config, i0.ElementRef, i0.Renderer], { name: [0, \"name\"] }, null), (_l()(), i0.ɵted(-1, 0, [\"\\n            \"]))], function (_ck, _v) { var currVal_1 = \"bookmark\"; _ck(_v, 4, 0, currVal_1); }, function (_ck, _v) { var currVal_0 = i0.ɵnov(_v, 4)._hidden; _ck(_v, 3, 0, currVal_0); }); }\nfunction View_AddonModScormPlayerPage_2(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 1, \"ion-spinner\", [], [[2, \"spinner-paused\", null]], null, null, i5.View_Spinner_0, i5.RenderType_Spinner)), i0.ɵdid(1, 114688, null, 0, i6.Spinner, [i3.Config, i0.ElementRef, i0.Renderer], null, null)], function (_ck, _v) { _ck(_v, 1, 0); }, function (_ck, _v) { var currVal_0 = i0.ɵnov(_v, 1)._paused; _ck(_v, 0, 0, currVal_0); }); }\nfunction View_AddonModScormPlayerPage_3(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 1, \"core-iframe\", [], null, null, null, i7.View_CoreIframeComponent_0, i7.RenderType_CoreIframeComponent)), i0.ɵdid(1, 638976, null, 0, i8.CoreIframeComponent, [i9.CoreLoggerProvider, i10.CoreIframeUtilsProvider, i11.CoreDomUtilsProvider, i12.DomSanitizer], { src: [0, \"src\"], iframeWidth: [1, \"iframeWidth\"], iframeHeight: [2, \"iframeHeight\"] }, null)], function (_ck, _v) { var _co = _v.component; var currVal_0 = _co.src; var currVal_1 = (_co.scorm.popup ? _co.scorm.width : undefined); var currVal_2 = (_co.scorm.popup ? _co.scorm.height : undefined); _ck(_v, 1, 0, currVal_0, currVal_1, currVal_2); }, null); }\nfunction View_AddonModScormPlayerPage_4(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 2, \"p\", [], null, null, null, null, null)), (_l()(), i0.ɵted(1, null, [\"\", \"\"])), i0.ɵpid(131072, i13.TranslatePipe, [i14.TranslateService, i0.ChangeDetectorRef])], null, function (_ck, _v) { var _co = _v.component; var currVal_0 = i0.ɵunv(_v, 1, 0, i0.ɵnov(_v, 2).transform(_co.errorMessage)); _ck(_v, 1, 0, currVal_0); }); }\nexport function View_AddonModScormPlayerPage_0(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 23, \"ion-header\", [], null, null, null, null, null)), i0.ɵdid(1, 16384, null, 0, i15.Header, [i3.Config, i0.ElementRef, i0.Renderer, [2, i16.ViewController]], null, null), (_l()(), i0.ɵted(-1, null, [\"\\n    \"])), (_l()(), i0.ɵeld(3, 0, null, null, 19, \"ion-navbar\", [[\"class\", \"toolbar\"], [\"core-back-button\", \"\"]], [[8, \"hidden\", 0], [2, \"statusbar-padding\", null]], null, null, i17.View_Navbar_0, i17.RenderType_Navbar)), i0.ɵdid(4, 49152, null, 0, i18.Navbar, [i19.App, [2, i16.ViewController], [2, i20.NavController], i3.Config, i0.ElementRef, i0.Renderer], null, null), i0.ɵdid(5, 212992, null, 0, i21.CoreBackButtonDirective, [i18.Navbar, i22.Platform, i14.TranslateService, i23.CoreEventsProvider], null, null), (_l()(), i0.ɵted(-1, 3, [\"\\n        \"])), (_l()(), i0.ɵeld(7, 0, null, 3, 3, \"ion-title\", [], null, null, null, i24.View_ToolbarTitle_0, i24.RenderType_ToolbarTitle)), i0.ɵdid(8, 49152, null, 0, i25.ToolbarTitle, [i3.Config, i0.ElementRef, i0.Renderer, [2, i26.Toolbar], [2, i18.Navbar]], null, null), (_l()(), i0.ɵeld(9, 0, null, 0, 1, \"core-format-text\", [], null, null, null, null, null)), i0.ɵdid(10, 540672, null, 0, i27.CoreFormatTextDirective, [i0.ElementRef, i28.CoreSitesProvider, i11.CoreDomUtilsProvider, i29.CoreTextUtilsProvider, i14.TranslateService, i22.Platform, i30.CoreUtilsProvider, i31.CoreUrlUtilsProvider, i9.CoreLoggerProvider, i32.CoreFilepoolProvider, i33.CoreAppProvider, i34.CoreContentLinksHelperProvider, [2, i20.NavController], [2, i35.Content], [2, i36.CoreSplitViewComponent], i10.CoreIframeUtilsProvider, i23.CoreEventsProvider], { text: [0, \"text\"] }, null), (_l()(), i0.ɵted(-1, 3, [\"\\n\\n        \"])), (_l()(), i0.ɵeld(12, 0, null, 2, 9, \"ion-buttons\", [[\"end\", \"\"]], null, null, null, null, null)), i0.ɵdid(13, 16384, null, 1, i37.ToolbarItem, [i3.Config, i0.ElementRef, i0.Renderer, [2, i26.Toolbar], [2, i18.Navbar]], null, null), i0.ɵqud(603979776, 1, { _buttons: 1 }), (_l()(), i0.ɵted(-1, null, [\"\\n            \"])), (_l()(), i0.ɵand(16777216, null, null, 1, null, View_AddonModScormPlayerPage_1)), i0.ɵdid(17, 16384, null, 0, i38.NgIf, [i0.ViewContainerRef, i0.TemplateRef], { ngIf: [0, \"ngIf\"] }, null), (_l()(), i0.ɵted(-1, null, [\"\\n            \"])), (_l()(), i0.ɵand(16777216, null, null, 1, null, View_AddonModScormPlayerPage_2)), i0.ɵdid(20, 16384, null, 0, i38.NgIf, [i0.ViewContainerRef, i0.TemplateRef], { ngIf: [0, \"ngIf\"] }, null), (_l()(), i0.ɵted(-1, null, [\"\\n        \"])), (_l()(), i0.ɵted(-1, 3, [\"\\n    \"])), (_l()(), i0.ɵted(-1, null, [\"\\n\"])), (_l()(), i0.ɵted(-1, null, [\"\\n\"])), (_l()(), i0.ɵeld(25, 0, null, null, 15, \"ion-content\", [], [[2, \"statusbar-padding\", null], [2, \"has-refresher\", null]], null, null, i39.View_Content_0, i39.RenderType_Content)), i0.ɵdid(26, 4374528, null, 0, i35.Content, [i3.Config, i22.Platform, i40.DomController, i0.ElementRef, i0.Renderer, i19.App, i41.Keyboard, i0.NgZone, [2, i16.ViewController], [2, i20.NavController]], null, null), (_l()(), i0.ɵted(-1, 1, [\"\\n    \"])), (_l()(), i0.ɵeld(28, 0, null, 1, 11, \"core-loading\", [], null, null, null, i42.View_CoreLoadingComponent_0, i42.RenderType_CoreLoadingComponent)), i0.ɵdid(29, 638976, null, 0, i43.CoreLoadingComponent, [i14.TranslateService, i0.ElementRef, i23.CoreEventsProvider, i30.CoreUtilsProvider], { hideUntil: [0, \"hideUntil\"] }, null), (_l()(), i0.ɵted(-1, 0, [\"\\n        \"])), (_l()(), i0.ɵeld(31, 0, null, 0, 1, \"core-navigation-bar\", [], null, [[null, \"action\"]], function (_v, en, $event) { var ad = true; var _co = _v.component; if ((\"action\" === en)) {\n        var pd_0 = (_co.loadSco($event) !== false);\n        ad = (pd_0 && ad);\n    } return ad; }, i44.View_CoreNavigationBarComponent_0, i44.RenderType_CoreNavigationBarComponent)), i0.ɵdid(32, 49152, null, 0, i45.CoreNavigationBarComponent, [i29.CoreTextUtilsProvider], { previous: [0, \"previous\"], next: [1, \"next\"] }, { action: \"action\" }), (_l()(), i0.ɵted(-1, 0, [\"\\n        \"])), (_l()(), i0.ɵand(16777216, null, 0, 1, null, View_AddonModScormPlayerPage_3)), i0.ɵdid(35, 16384, null, 0, i38.NgIf, [i0.ViewContainerRef, i0.TemplateRef], { ngIf: [0, \"ngIf\"] }, null), (_l()(), i0.ɵted(-1, 0, [\"\\n        \"])), (_l()(), i0.ɵand(16777216, null, 0, 1, null, View_AddonModScormPlayerPage_4)), i0.ɵdid(38, 16384, null, 0, i38.NgIf, [i0.ViewContainerRef, i0.TemplateRef], { ngIf: [0, \"ngIf\"] }, null), (_l()(), i0.ɵted(-1, 0, [\"\\n    \"])), (_l()(), i0.ɵted(-1, 1, [\"\\n\"])), (_l()(), i0.ɵted(-1, null, [\"\\n\"]))], function (_ck, _v) { var _co = _v.component; _ck(_v, 5, 0); var currVal_2 = _co.title; _ck(_v, 10, 0, currVal_2); var currVal_3 = (((_co.showToc && !_co.loadingToc) && _co.toc) && _co.toc.length); _ck(_v, 17, 0, currVal_3); var currVal_4 = (_co.showToc && _co.loadingToc); _ck(_v, 20, 0, currVal_4); var currVal_7 = _co.loaded; _ck(_v, 29, 0, currVal_7); var currVal_8 = _co.previousSco; var currVal_9 = _co.nextSco; _ck(_v, 32, 0, currVal_8, currVal_9); var currVal_10 = (_co.loaded && _co.src); _ck(_v, 35, 0, currVal_10); var currVal_11 = (!_co.src && _co.errorMessage); _ck(_v, 38, 0, currVal_11); }, function (_ck, _v) { var currVal_0 = i0.ɵnov(_v, 4)._hidden; var currVal_1 = i0.ɵnov(_v, 4)._sbPadding; _ck(_v, 3, 0, currVal_0, currVal_1); var currVal_5 = i0.ɵnov(_v, 26).statusbarPadding; var currVal_6 = i0.ɵnov(_v, 26)._hasRefresher; _ck(_v, 25, 0, currVal_5, currVal_6); }); }\nexport function View_AddonModScormPlayerPage_Host_0(_l) { return i0.ɵvid(0, [(_l()(), i0.ɵeld(0, 0, null, null, 1, \"page-addon-mod-scorm-player\", [], null, null, null, View_AddonModScormPlayerPage_0, RenderType_AddonModScormPlayerPage)), i0.ɵdid(1, 245760, null, 0, i46.AddonModScormPlayerPage, [i47.NavParams, i48.PopoverController, i23.CoreEventsProvider, i28.CoreSitesProvider, i49.CoreSyncProvider, i11.CoreDomUtilsProvider, i50.CoreTimeUtilsProvider, i51.AddonModScormProvider, i52.AddonModScormHelperProvider, i53.AddonModScormSyncProvider], null, null)], function (_ck, _v) { _ck(_v, 1, 0); }, null); }\nvar AddonModScormPlayerPageNgFactory = i0.ɵccf(\"page-addon-mod-scorm-player\", i46.AddonModScormPlayerPage, View_AddonModScormPlayerPage_Host_0, {}, {}, []);\nexport { AddonModScormPlayerPageNgFactory as AddonModScormPlayerPageNgFactory };\n//# sourceMappingURL=player.ngfactory.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/scorm/pages/player/player.ngfactory.js.pre-build-optimizer.js","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CoreEventsProvider } from '@providers/events';\nimport { AddonModScormProvider } from '../providers/scorm';\n\n/**\n * SCORM data model implementation for version 1.2.\n */\nexport class AddonModScormDataModel12 {\n\n    // Standard Data Type Definition.\n    protected CMI_STRING_256 = '^[\\\\u0000-\\\\uFFFF]{0,255}$';\n    protected CMI_STRING_4096 = '^[\\\\u0000-\\\\uFFFF]{0,4096}$';\n    protected CMI_TIME = '^([0-2]{1}[0-9]{1}):([0-5]{1}[0-9]{1}):([0-5]{1}[0-9]{1})(\\.[0-9]{1,2})?$';\n    protected CMI_TIMESPAN = '^([0-9]{2,4}):([0-9]{2}):([0-9]{2})(\\.[0-9]{1,2})?$';\n    protected CMI_INTEGER = '^\\\\d+$';\n    protected CMI_SINTEGER = '^-?([0-9]+)$';\n    protected CMI_DECIMAL = '^-?([0-9]{0,3})(\\.[0-9]*)?$';\n    protected CMI_IDENTIFIER = '^[\\\\u0021-\\\\u007E]{0,255}$';\n    protected CMI_FEEDBACK = this.CMI_STRING_256; // This must be redefined.\n    protected CMI_INDEX = '[._](\\\\d+).';\n\n    // Vocabulary Data Type Definition.\n    protected CMI_STATUS = '^passed$|^completed$|^failed$|^incomplete$|^browsed$';\n    protected CMI_STATUS_2 = '^passed$|^completed$|^failed$|^incomplete$|^browsed$|^not attempted$';\n    protected CMI_EXIT = '^time-out$|^suspend$|^logout$|^$';\n    protected CMI_TYPE = '^true-false$|^choice$|^fill-in$|^matching$|^performance$|^sequencing$|^likert$|^numeric$';\n    protected CMI_RESULT = '^correct$|^wrong$|^unanticipated$|^neutral$|^([0-9]{0,3})?(\\.[0-9]*)?$';\n    protected NAV_EVENT = '^previous$|^continue$';\n\n    // Children lists.\n    protected CMI_CHILDREN = 'core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions';\n    protected CORE_CHILDREN = 'student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,' +\n            'exit,session_time';\n    protected SCORE_CHILDREN = 'raw,min,max';\n    protected COMMENTS_CHILDREN = 'content,location,time';\n    protected OBJECTIVES_CHILDREN = 'id,score,status';\n    protected CORRECT_RESPONSES_CHILDREN = 'pattern';\n    protected STUDENT_DATA_CHILDREN = 'mastery_score,max_time_allowed,time_limit_action';\n    protected STUDENT_PREFERENCE_CHILDREN = 'audio,language,speed,text';\n    protected INTERACTIONS_CHILDREN = 'id,objectives,time,type,correct_responses,weighting,student_response,result,latency';\n\n    // Data ranges.\n    protected SCORE_RANGE = '0#100';\n    protected AUDIO_RANGE = '-1#100';\n    protected SPEED_RANGE = '-100#100';\n    protected WEIGHTING_RANGE = '-100#100';\n    protected TEXT_RANGE = '-1#1';\n\n    // Error messages.\n    protected ERROR_STRINGS = {\n        0: 'No error',\n        101: 'General exception',\n        201: 'Invalid argument error',\n        202: 'Element cannot have children',\n        203: 'Element not an array - cannot have count',\n        301: 'Not initialized',\n        401: 'Not implemented error',\n        402: 'Invalid set value, element is a keyword',\n        403: 'Element is read only',\n        404: 'Element is write only',\n        405: 'Incorrect data type'\n    };\n\n    protected currentUserData = {}; // Current user data.\n    protected def = {}; // Object containing the default values.\n    protected defExtra = {}; // Extra object that will contain the objectives and interactions data (all the .n. elements).\n    protected dataModel = {}; // The SCORM 1.2 data model.\n\n    protected initialized = false; // Whether LMSInitialize has been called.\n    protected errorCode: string; // Last error.\n    protected timeout; // Timeout to commit changes.\n\n    /**\n     * Constructor.\n     *\n     * @param {CoreEventsProvider} eventsProvider Events provider instance.\n     * @param {AddonModScormProvider} scormProvider SCORM provider instance.\n     * @param {any} scorm SCORM.\n     * @param {number} scoId Current SCO ID.\n     * @param {number} attempt Attempt number.\n     * @param {any} userData The user default data.\n     * @param {string} [mode] Mode being played. By default, MODENORMAL.\n     * @param {boolean} offline Whether the attempt is offline.\n     */\n    constructor(protected eventsProvider: CoreEventsProvider, protected scormProvider: AddonModScormProvider,\n            protected siteId: string, protected scorm: any, protected scoId: number, protected attempt: number,\n            userData: any, protected mode?: string, protected offline?: boolean) {\n\n        this.mode = mode || AddonModScormProvider.MODENORMAL;\n        this.offline = !!offline;\n\n        this.init(userData);\n    }\n\n    /**\n     * Utility function for adding two times in format hh:mm:ss.\n     *\n     * @param {string} first  First time.\n     * @param {string} second Second time.\n     * @return {string} Total time.\n     */\n    protected addTime(first: string, second: string): string {\n        const sFirst = first.split(':'),\n            sSecond = second.split(':'),\n            cFirst = sFirst[2].split('.'),\n            cSecond = sSecond[2].split('.');\n        let change = 0;\n\n        let firstCents = 0; // Cents.\n        if (cFirst.length > 1) {\n            firstCents = parseInt(cFirst[1], 10);\n        }\n\n        let secondCents = 0;\n        if (cSecond.length > 1) {\n            secondCents = parseInt(cSecond[1], 10);\n        }\n\n        let cents: string | number = firstCents + secondCents;\n        change = Math.floor(cents / 100);\n        cents = cents - (change * 100);\n        if (Math.floor(cents) < 10) {\n            cents = '0' + cents.toString();\n        }\n\n        let secs: string | number = parseInt(cFirst[0], 10) + parseInt(cSecond[0], 10) + change; // Seconds.\n        change = Math.floor(secs / 60);\n        secs = secs - (change * 60);\n        if (Math.floor(secs) < 10) {\n            secs = '0' + secs.toString();\n        }\n\n        let mins: string | number = parseInt(sFirst[1], 10) + parseInt(sSecond[1], 10) + change; // Minutes.\n        change = Math.floor(mins / 60);\n        mins = mins - (change * 60);\n        if (mins < 10) {\n            mins = '0' + mins.toString();\n        }\n\n        let hours: string | number = parseInt(sFirst[0], 10) + parseInt(sSecond[0], 10) + change; // Hours.\n        if (hours < 10) {\n            hours = '0' + hours.toString();\n        }\n\n        if (cents != '0') {\n            return hours + ':' + mins + ':' + secs + '.' + cents;\n        } else {\n            return hours + ':' + mins + ':' + secs;\n        }\n    }\n\n    /**\n     * Utility function for cloning an object\n     *\n     * @param {any} obj The object to be cloned\n     * @return {any} The object cloned\n     */\n    protected cloneObj(obj: any): any {\n        if (obj == null || typeof(obj) != 'object') {\n            return obj;\n        }\n\n        const temp = new obj.constructor(); // Changed (twice).\n        for (const key in obj) {\n            temp[key] = this.cloneObj(obj[key]);\n        }\n\n        return temp;\n    }\n\n    /**\n     * Collect all the user tracking data that must be persisted in the system, this is usually called by LMSCommit().\n     *\n     * @return {any[]} Collected data.\n     */\n    protected collectData(): any[] {\n        const data = [];\n\n        for (const element in this.currentUserData[this.scoId]) {\n            // Ommit for example the nav. elements.\n            if (element.substr(0, 3) == 'cmi') {\n                const expression = new RegExp(this.CMI_INDEX, 'g');\n\n                // Get the generic name for this element (e.g. convert 'cmi.interactions.1.id' to 'cmi.interactions.n.id')\n                const elementModel = String(element).replace(expression, '.n.');\n\n                // Ignore the session time element.\n                if (element != 'cmi.core.session_time') {\n\n                    // Check if this specific element is not defined in the datamodel, but the generic element name is.\n                    if (typeof this.dataModel[this.scoId][element] == 'undefined' &&\n                            typeof this.dataModel[this.scoId][elementModel] != 'undefined') {\n\n                        // Add this element to the data model (by cloning the generic element) so we can track changes to it.\n                        this.dataModel[this.scoId][element] = this.cloneObj(this.dataModel[this.scoId][elementModel]);\n                    }\n\n                    // Check if the current element exists in the datamodel.\n                    if (typeof this.dataModel[this.scoId][element] != 'undefined') {\n\n                        // Make sure this is not a read only element.\n                        if (this.dataModel[this.scoId][element].mod != 'r') {\n\n                            const el = {\n                                // Moodle stores the organizations and interactions using _n. instead .n.\n                                element: element.replace(expression, '_$1.'),\n                                value: this.getEl(element)\n                            };\n\n                            // Check if the element has a default value.\n                            if (typeof this.dataModel[this.scoId][element].defaultvalue != 'undefined') {\n\n                                // Check if the default value is different from the current value.\n                                if (this.dataModel[this.scoId][element].defaultvalue != el.value ||\n                                        typeof this.dataModel[this.scoId][element].defaultvalue != typeof(el.value)) {\n\n                                    data.push(el);\n\n                                    // Update the element default to reflect the current committed value.\n                                    this.dataModel[this.scoId][element].defaultvalue = el.value;\n                                }\n                            } else {\n                                data.push(el);\n\n                                // No default value for the element, so set it now.\n                                this.dataModel[this.scoId][element].defaultvalue = el.value;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        return data;\n    }\n\n    /**\n     * Get the value of the given element from the non-persistent (current) user data.\n     *\n     * @param {string} el The element\n     * @return {any} The element value\n     */\n    protected getEl(el: string): any {\n        if (typeof this.currentUserData[this.scoId] != 'undefined' && typeof this.currentUserData[this.scoId][el] != 'undefined') {\n            return this.currentUserData[this.scoId][el];\n        }\n\n        return '';\n    }\n\n    /**\n     * Initialize the model.\n     *\n     * @param {any} userData The user default data.\n     */\n    protected init(userData: any): void {\n        // Prepare the definition array containing the default values.\n        for (const scoId in userData) {\n            const sco = userData[scoId];\n            this.def[scoId] = sco.defaultdata;\n            this.defExtra[scoId] = sco.userdata;\n        }\n\n        // Set up data model for each SCO.\n        for (const scoId in this.def) {\n            this.dataModel[scoId] = {\n                'cmi._children': { defaultvalue: this.CMI_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi._version': { defaultvalue: '3.4', mod: 'r', writeerror: '402' },\n                'cmi.core._children': { defaultvalue: this.CORE_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.core.student_id': { defaultvalue: this.def[scoId]['cmi.core.student_id'], mod: 'r', writeerror: '403' },\n                'cmi.core.student_name': { defaultvalue: this.def[scoId]['cmi.core.student_name'], mod: 'r', writeerror: '403' },\n                'cmi.core.lesson_location': { defaultvalue: this.def[scoId]['cmi.core.lesson_location'],\n                        format: this.CMI_STRING_256, mod: 'rw', writeerror: '405' },\n                'cmi.core.credit': { defaultvalue: this.def[scoId]['cmi.core.credit'], mod: 'r', writeerror: '403' },\n                'cmi.core.lesson_status': { defaultvalue: this.def[scoId]['cmi.core.lesson_status'], format: this.CMI_STATUS,\n                        mod: 'rw', writeerror: '405' },\n                'cmi.core.entry': { defaultvalue: this.def[scoId]['cmi.core.entry'], mod: 'r', writeerror: '403' },\n                'cmi.core.score._children': { defaultvalue: this.SCORE_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.core.score.raw': { defaultvalue: this.def[scoId]['cmi.core.score.raw'], format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.core.score.max': { defaultvalue: this.def[scoId]['cmi.core.score.max'], format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.core.score.min': { defaultvalue: this.def[scoId]['cmi.core.score.min'], format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.core.total_time': { defaultvalue: this.def[scoId]['cmi.core.total_time'], mod: 'r', writeerror: '403' },\n                'cmi.core.lesson_mode': { defaultvalue: this.def[scoId]['cmi.core.lesson_mode'], mod: 'r', writeerror: '403' },\n                'cmi.core.exit': { defaultvalue: this.def[scoId]['cmi.core.exit'], format: this.CMI_EXIT, mod: 'w',\n                        readerror: '404', writeerror: '405' },\n                'cmi.core.session_time': { format: this.CMI_TIMESPAN, mod: 'w', defaultvalue: '00:00:00', readerror: '404',\n                        writeerror: '405' },\n                'cmi.suspend_data': { defaultvalue: this.def[scoId]['cmi.suspend_data'], format: this.CMI_STRING_4096,\n                        mod: 'rw', writeerror: '405' },\n                'cmi.launch_data': { defaultvalue: this.def[scoId]['cmi.launch_data'], mod: 'r', writeerror: '403' },\n                'cmi.comments': { defaultvalue: this.def[scoId]['cmi.comments'], format: this.CMI_STRING_4096, mod: 'rw',\n                        writeerror: '405' },\n                // Deprecated evaluation attributes.\n                'cmi.evaluation.comments._count': { defaultvalue: '0', mod: 'r', writeerror: '402' },\n                'cmi.evaluation.comments._children': { defaultvalue: this.COMMENTS_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.evaluation.comments.n.content': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_STRING_256,\n                        mod: 'rw', writeerror: '405' },\n                'cmi.evaluation.comments.n.location': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_STRING_256,\n                        mod: 'rw', writeerror: '405' },\n                'cmi.evaluation.comments.n.time': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_TIME,\n                        mod: 'rw', writeerror: '405' },\n                'cmi.comments_from_lms': { mod: 'r', writeerror: '403' },\n                'cmi.objectives._children': { defaultvalue: this.OBJECTIVES_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.objectives._count': { mod: 'r', defaultvalue: '0', writeerror: '402' },\n                'cmi.objectives.n.id': { pattern: this.CMI_INDEX, format: this.CMI_IDENTIFIER, mod: 'rw', writeerror: '405' },\n                'cmi.objectives.n.score._children': { pattern: this.CMI_INDEX, mod: 'r', writeerror: '402' },\n                'cmi.objectives.n.score.raw': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.objectives.n.score.min': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.objectives.n.score.max': { defaultvalue: '', pattern: this.CMI_INDEX, format: this.CMI_DECIMAL,\n                        range: this.SCORE_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.objectives.n.status': { pattern: this.CMI_INDEX, format: this.CMI_STATUS_2, mod: 'rw', writeerror: '405' },\n                'cmi.student_data._children': { defaultvalue: this.STUDENT_DATA_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.student_data.mastery_score': { defaultvalue: this.def[scoId]['cmi.student_data.mastery_score'], mod: 'r',\n                        writeerror: '403' },\n                'cmi.student_data.max_time_allowed': { defaultvalue: this.def[scoId]['cmi.student_data.max_time_allowed'],\n                        mod: 'r', writeerror: '403' },\n                'cmi.student_data.time_limit_action': { defaultvalue: this.def[scoId]['cmi.student_data.time_limit_action'],\n                        mod: 'r', writeerror: '403' },\n                'cmi.student_preference._children': { defaultvalue: this.STUDENT_PREFERENCE_CHILDREN, mod: 'r',\n                        writeerror: '402' },\n                'cmi.student_preference.audio': { defaultvalue: this.def[scoId]['cmi.student_preference.audio'],\n                        format: this.CMI_SINTEGER, range: this.AUDIO_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.student_preference.language': { defaultvalue: this.def[scoId]['cmi.student_preference.language'],\n                        format: this.CMI_STRING_256, mod: 'rw', writeerror: '405' },\n                'cmi.student_preference.speed': { defaultvalue: this.def[scoId]['cmi.student_preference.speed'],\n                        format: this.CMI_SINTEGER, range: this.SPEED_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.student_preference.text': { defaultvalue: this.def[scoId]['cmi.student_preference.text'],\n                        format: this.CMI_SINTEGER, range: this.TEXT_RANGE, mod: 'rw', writeerror: '405' },\n                'cmi.interactions._children': { defaultvalue: this.INTERACTIONS_CHILDREN, mod: 'r', writeerror: '402' },\n                'cmi.interactions._count': { mod: 'r', defaultvalue: '0', writeerror: '402' },\n                'cmi.interactions.n.id': { pattern: this.CMI_INDEX, format: this.CMI_IDENTIFIER, mod: 'w', readerror: '404',\n                        writeerror: '405' },\n                'cmi.interactions.n.objectives._count': { pattern: this.CMI_INDEX, mod: 'r', defaultvalue: '0', writeerror: '402' },\n                'cmi.interactions.n.objectives.n.id': { pattern: this.CMI_INDEX, format: this.CMI_IDENTIFIER, mod: 'w',\n                        readerror: '404', writeerror: '405' },\n                'cmi.interactions.n.time': { pattern: this.CMI_INDEX, format: this.CMI_TIME, mod: 'w', readerror: '404',\n                        writeerror: '405' },\n                'cmi.interactions.n.type': { pattern: this.CMI_INDEX, format: this.CMI_TYPE, mod: 'w', readerror: '404',\n                        writeerror: '405' },\n                'cmi.interactions.n.correct_responses._count': { pattern: this.CMI_INDEX, mod: 'r', defaultvalue: '0',\n                        writeerror: '402' },\n                'cmi.interactions.n.correct_responses.n.pattern': { pattern: this.CMI_INDEX, format: this.CMI_FEEDBACK,\n                        mod: 'w', readerror: '404', writeerror: '405' },\n                'cmi.interactions.n.weighting': { pattern: this.CMI_INDEX, format: this.CMI_DECIMAL,\n                        range: this.WEIGHTING_RANGE, mod: 'w', readerror: '404', writeerror: '405' },\n                'cmi.interactions.n.student_response': { pattern: this.CMI_INDEX, format: this.CMI_FEEDBACK, mod: 'w',\n                        readerror: '404', writeerror: '405' },\n                'cmi.interactions.n.result': { pattern: this.CMI_INDEX, format: this.CMI_RESULT, mod: 'w', readerror: '404',\n                        writeerror: '405' },\n                'cmi.interactions.n.latency': { pattern: this.CMI_INDEX, format: this.CMI_TIMESPAN, mod: 'w',\n                        readerror: '404', writeerror: '405' },\n                'nav.event': { defaultvalue: '', format: this.NAV_EVENT, mod: 'w', readerror: '404', writeerror: '405' }\n            };\n\n            this.currentUserData[scoId] = {};\n\n            // Load default values.\n            for (const element in this.dataModel[scoId]) {\n                if (element.match(/\\.n\\./) === null) {\n                    if (typeof this.dataModel[scoId][element].defaultvalue != 'undefined') {\n                        this.currentUserData[scoId][element] = this.dataModel[scoId][element].defaultvalue;\n                    }\n                }\n            }\n\n            // Load initial user data for current SCO.\n            for (const element in this.def[scoId]) {\n                if (element.match(/\\.n\\./) === null) {\n                    if (typeof this.dataModel[scoId][element].defaultvalue != 'undefined') {\n                        this.currentUserData[scoId][element] = this.dataModel[scoId][element].defaultvalue;\n                    } else if (typeof this.defExtra[scoId][element] != 'undefined') {\n                        // Check in user data values.\n                        this.currentUserData[scoId][element] = this.defExtra[scoId][element];\n                    } else {\n                        this.currentUserData[scoId][element] = '';\n                    }\n                }\n            }\n\n            // Load interactions and objectives, and init the counters.\n            const expression = new RegExp(this.CMI_INDEX, 'g');\n\n            for (const element in this.defExtra[scoId]) {\n                let counterElement = '',\n                    currentCounterIndex: any = 0,\n                    elementDotFormat,\n                    currentN;\n\n                // This check for an indexed element. cmi.objectives.1.id or cmi.objectives_1.id.\n                if (element.match(expression)) {\n                    // Normalize to the expected value according the standard.\n                    // Moodle stores this values using _n. instead .n.\n                    elementDotFormat = element.replace(expression, '.$1.');\n                    this.currentUserData[scoId][elementDotFormat] = this.defExtra[scoId][element];\n\n                    // Get the correct counter and current index.\n                    if (elementDotFormat.indexOf('cmi.evaluation.comments') === 0) {\n                        counterElement = 'cmi.evaluation.comments._count';\n                        currentCounterIndex = elementDotFormat.match(/.(\\d+)./)[1];\n                    } else if (elementDotFormat.indexOf('cmi.objectives') === 0) {\n                        counterElement = 'cmi.objectives._count';\n                        currentCounterIndex = elementDotFormat.match(/.(\\d+)./)[1];\n                    } else if (elementDotFormat.indexOf('cmi.interactions') === 0) {\n                        if (elementDotFormat.indexOf('.objectives.') > 0) {\n                            currentN = elementDotFormat.match(/cmi.interactions.(\\d+)./)[1];\n                            currentCounterIndex = elementDotFormat.match(/objectives.(\\d+)./)[1];\n                            counterElement = 'cmi.interactions.' + currentN + '.objectives._count';\n                        } else if (elementDotFormat.indexOf('.correct_responses.') > 0) {\n                            currentN = elementDotFormat.match(/cmi.interactions.(\\d+)./)[1];\n                            currentCounterIndex = elementDotFormat.match(/correct_responses.(\\d+)./)[1];\n                            counterElement = 'cmi.interactions.' + currentN + '.correct_responses._count';\n                        } else {\n                            counterElement = 'cmi.interactions._count';\n                            currentCounterIndex = elementDotFormat.match(/.(\\d+)./)[1];\n                        }\n                    }\n\n                    if (counterElement) {\n                        if (typeof this.currentUserData[scoId][counterElement] == 'undefined') {\n                            this.currentUserData[scoId][counterElement] = 0;\n                        }\n                        // Check if we need to sum.\n                        if (parseInt(currentCounterIndex) == parseInt(this.currentUserData[scoId][counterElement])) {\n                            this.currentUserData[scoId][counterElement] = parseInt(this.currentUserData[scoId][counterElement]) + 1;\n                        }\n                        if (parseInt(currentCounterIndex) > parseInt(this.currentUserData[scoId][counterElement])) {\n                            this.currentUserData[scoId][counterElement] = parseInt(currentCounterIndex) - 1;\n                        }\n                    }\n\n                }\n            }\n\n            // Set default status.\n            if (this.currentUserData[scoId]['cmi.core.lesson_status'] === '') {\n                this.currentUserData[scoId]['cmi.core.lesson_status'] = 'not attempted';\n            }\n\n            // Define mode and credit.\n            this.currentUserData[scoId]['cmi.core.credit'] = this.mode == AddonModScormProvider.MODENORMAL ? 'credit' : 'no-credit';\n            this.currentUserData[scoId]['cmi.core.lesson_mode'] = this.mode;\n        }\n    }\n\n    /**\n     * Commit the changes.\n     *\n     * @param {string} param Param.\n     * @return {string} \"true\" if success, \"false\" otherwise.\n     */\n    LMSCommit(param: string): string {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n            this.timeout = null;\n        }\n\n        this.errorCode = '0';\n        if (param == '') {\n            if (this.initialized) {\n                const result = this.storeData(false);\n\n                // Trigger TOC update.\n                this.triggerEvent(AddonModScormProvider.UPDATE_TOC_EVENT);\n\n                this.errorCode = result ? '0' : '101';\n\n                // Conver to string representing a boolean.\n                return result ? 'true' : 'false';\n            } else {\n                this.errorCode = '301';\n            }\n        } else {\n            this.errorCode = '201';\n        }\n\n        return 'false';\n    }\n\n    /**\n     * Finish the data model.\n     *\n     * @param {string} param Param.\n     * @return {string} \"true\" if success, \"false\" otherwise.\n     */\n    LMSFinish(param: string): string {\n        this.errorCode = '0';\n\n        if (param == '') {\n            if (this.initialized) {\n                this.initialized = false;\n\n                const result = this.storeData(true);\n                if (this.getEl('nav.event') != '') {\n                    if (this.getEl('nav.event') == 'continue') {\n                        this.triggerEvent(AddonModScormProvider.LAUNCH_NEXT_SCO_EVENT);\n                    } else {\n                        this.triggerEvent(AddonModScormProvider.LAUNCH_PREV_SCO_EVENT);\n                    }\n                } else {\n                    if (this.scorm.auto == '1') {\n                        this.triggerEvent(AddonModScormProvider.LAUNCH_NEXT_SCO_EVENT);\n                    }\n                }\n\n                this.errorCode = result ? '0' : '101';\n\n                // Trigger TOC update.\n                this.triggerEvent(AddonModScormProvider.UPDATE_TOC_EVENT);\n\n                // Conver to string representing a boolean.\n                return result ? 'true' : 'false';\n            } else {\n                this.errorCode = '301';\n            }\n        } else {\n            this.errorCode = '201';\n        }\n\n        return 'false';\n    }\n\n    /**\n     * Get diagnostic.\n     *\n     * @param  {string} param Param.\n     * @return {string} Result.\n     */\n    LMSGetDiagnostic(param: string): string {\n        if (param == '') {\n            param = this.errorCode;\n        }\n\n        return param;\n    }\n\n    /**\n     * Get the error message for a certain code.\n     *\n     * @param {string} param Error code.\n     * @return {string} Error message.\n     */\n    LMSGetErrorString(param: string): string {\n        if (param != '') {\n            return this.ERROR_STRINGS[param];\n        } else {\n           return '';\n        }\n    }\n\n    /**\n     * Get the last error code.\n     *\n     * @return {string} Last error code.\n     */\n    LMSGetLastError(): string {\n        return this.errorCode;\n    }\n\n    /**\n     * Get the value of a certain element.\n     *\n     * @param {string} element Name of the element to get.\n     * @return {string} Value.\n     */\n    LMSGetValue(element: string): string {\n        this.errorCode = '0';\n\n        if (this.initialized) {\n            if (element != '') {\n                const expression = new RegExp(this.CMI_INDEX, 'g'),\n                    elementModel = String(element).replace(expression, '.n.');\n\n                if (typeof this.dataModel[this.scoId][elementModel] != 'undefined') {\n                    if (this.dataModel[this.scoId][elementModel].mod != 'w') {\n                        this.errorCode = '0';\n\n                        return this.getEl(element);\n                    } else {\n                        this.errorCode = this.dataModel[this.scoId][elementModel].readerror;\n                    }\n                } else {\n                    const childrenStr = '._children',\n                        countStr = '._count';\n\n                    if (elementModel.substr(elementModel.length - childrenStr.length, elementModel.length) == childrenStr) {\n                        const parentModel = elementModel.substr(0, elementModel.length - childrenStr.length);\n\n                        if (typeof this.dataModel[this.scoId][parentModel] != 'undefined') {\n                            this.errorCode = '202';\n                        } else {\n                            this.errorCode = '201';\n                        }\n                    } else if (elementModel.substr(elementModel.length - countStr.length, elementModel.length) == countStr) {\n                        const parentModel = elementModel.substr(0, elementModel.length - countStr.length);\n\n                        if (typeof this.dataModel[this.scoId][parentModel] != 'undefined') {\n                            this.errorCode = '203';\n                        } else {\n                            this.errorCode = '201';\n                        }\n                    } else {\n                        this.errorCode = '201';\n                    }\n                }\n            } else {\n                this.errorCode = '201';\n            }\n        } else {\n            this.errorCode = '301';\n        }\n\n        return '';\n    }\n\n    /**\n     * Initialize the data model.\n     *\n     * @param {string} param Param.\n     * @return {string} \"true\" if initialized, \"false\" otherwise.\n     */\n    LMSInitialize(param: string): string {\n        this.errorCode = '0';\n\n        if (param == '') {\n            if (!this.initialized) {\n                this.initialized = true;\n                this.errorCode = '0';\n\n                return 'true';\n            } else {\n                this.errorCode = '101';\n            }\n        } else {\n            this.errorCode = '201';\n        }\n\n        return 'false';\n    }\n\n    /**\n     * Set the value of a certain element.\n     *\n     * @param {string} element Name of the element to set.\n     * @param {any} value Value to set.\n     * @return {string} \"true\" if success, \"false\" otherwise.\n     */\n    LMSSetValue(element: string, value: any): string {\n        this.errorCode = '0';\n\n        if (this.initialized) {\n            if (element != '') {\n                let expression = new RegExp(this.CMI_INDEX, 'g');\n                const elementModel = String(element).replace(expression, '.n.');\n\n                if (typeof this.dataModel[this.scoId][elementModel] != 'undefined') {\n                    if (this.dataModel[this.scoId][elementModel].mod != 'r') {\n                        expression = new RegExp(this.dataModel[this.scoId][elementModel].format);\n                        value = value + '';\n\n                        const matches = value.match(expression);\n\n                        if (matches != null) {\n                            // Create dynamic data model element.\n                            if (element != elementModel) {\n\n                                // Init default counters and values.\n                                if (element.indexOf('cmi.objectives') === 0) {\n                                    const currentN = element.match(/cmi.objectives.(\\d+)./)[1],\n                                        counterElement = 'cmi.objectives.' + currentN + '.score';\n\n                                    if (typeof this.currentUserData[this.scoId][counterElement + '._children'] == 'undefined') {\n                                        this.setEl(this.currentUserData[this.scoId][counterElement + '._children'],\n                                                this.SCORE_CHILDREN);\n                                        this.setEl(this.currentUserData[this.scoId][counterElement + '.raw'], '');\n                                        this.setEl(this.currentUserData[this.scoId][counterElement + '.min'], '');\n                                        this.setEl(this.currentUserData[this.scoId][counterElement + '.max'], '');\n                                    }\n\n                                } else if (element.indexOf('cmi.interactions') === 0) {\n                                    const currentN = element.match(/cmi.interactions.(\\d+)./)[1];\n                                    let counterElement = 'cmi.interactions.' + currentN + '.objectives._count';\n\n                                    if (typeof this.currentUserData[this.scoId][counterElement] == 'undefined') {\n                                        this.setEl(counterElement, 0);\n                                    }\n\n                                    counterElement = 'cmi.interactions.' + currentN + '.correct_responses._count';\n                                    if (typeof this.currentUserData[this.scoId][counterElement] == 'undefined') {\n                                        this.setEl(counterElement, 0);\n                                    }\n                                }\n\n                                const elementIndexes = element.split('.');\n                                let subElement = 'cmi';\n\n                                for (let i = 1; i < elementIndexes.length - 1; i++) {\n                                    const elementIndex = elementIndexes[i];\n\n                                    if (elementIndexes[i + 1].match(/^\\d+$/)) {\n                                        const counterElement = subElement + '.' + elementIndex + '._count';\n\n                                        if (typeof this.currentUserData[this.scoId][counterElement] == 'undefined') {\n                                            this.setEl(counterElement, 0);\n                                        }\n\n                                        if (elementIndexes[i + 1] == this.getEl(counterElement)) {\n                                            const count = this.getEl(counterElement);\n                                            this.setEl(counterElement, parseInt(count, 10) + 1);\n                                        }\n\n                                        if (elementIndexes[i + 1] > this.getEl(counterElement)) {\n                                            this.errorCode = '201';\n                                        }\n\n                                        subElement = subElement.concat('.' + elementIndex + '.' + elementIndexes[i + 1]);\n                                        i++;\n                                    } else {\n                                        subElement = subElement.concat('.' + elementIndex);\n                                    }\n                                }\n\n                                element = subElement.concat('.' + elementIndexes[elementIndexes.length - 1]);\n                            }\n\n                            // Store data.\n                            if (this.errorCode == '0') {\n                                if (this.scorm.autocommit && !(this.timeout)) {\n                                    this.timeout = setTimeout(this.LMSCommit.bind(this), 60000, ['']);\n                                }\n\n                                if (typeof this.dataModel[this.scoId][elementModel].range != 'undefined') {\n                                    const range = this.dataModel[this.scoId][elementModel].range,\n                                        ranges = range.split('#');\n\n                                    value = value * 1.0;\n                                    if ((value >= ranges[0]) && (value <= ranges[1])) {\n                                        this.setEl(element, value);\n                                        this.errorCode = '0';\n\n                                        return 'true';\n                                    } else {\n                                        this.errorCode = this.dataModel[this.scoId][elementModel].writeerror;\n                                    }\n                                } else {\n                                    if (element == 'cmi.comments') {\n                                        this.setEl('cmi.comments', this.getEl('cmi.comments') + value);\n                                    } else {\n                                        this.setEl(element, value);\n                                    }\n                                    this.errorCode = '0';\n\n                                    return 'true';\n                                }\n                            }\n                        } else {\n                            this.errorCode = this.dataModel[this.scoId][elementModel].writeerror;\n                        }\n                    } else {\n                        this.errorCode = this.dataModel[this.scoId][elementModel].writeerror;\n                    }\n                } else {\n                    this.errorCode = '201';\n                }\n            } else {\n                this.errorCode = '201';\n            }\n        } else {\n            this.errorCode = '301';\n        }\n\n        return 'false';\n    }\n\n    /**\n     * Set a SCO ID.\n     * The scoId is like a pointer to be able to retrieve the SCO default values and set the new ones in the overall SCORM\n     * data structure.\n     *\n     * @param {number} scoId The new SCO id.\n     */\n    loadSco(scoId: number): void {\n        this.scoId = scoId;\n    }\n\n    /**\n     * Set the value of the given element in the non-persistent (current) user data.\n     *\n     * @param {string} el The element.\n     * @param {any} value The value.\n     */\n    protected setEl(el: string, value: any): void {\n        if (typeof this.currentUserData[this.scoId] == 'undefined') {\n            this.currentUserData[this.scoId] = {};\n        }\n\n        this.currentUserData[this.scoId][el] = value;\n    }\n\n    /**\n     * Set offline mode to true or false.\n     *\n     * @param {boolean} offline True if offline, false otherwise.\n     */\n    setOffline(offline: boolean): void {\n        this.offline = offline;\n    }\n\n    /**\n     * Persist the current user data (this is usually called by LMSCommit).\n     *\n     * @param {boolean} storeTotalTime If true, we need to calculate the total time too.\n     * @return {boolean} True if success, false otherwise.\n     */\n    protected storeData(storeTotalTime?: boolean): boolean {\n        let tracks;\n\n        if (storeTotalTime) {\n            if (this.getEl('cmi.core.lesson_status') == 'not attempted') {\n                this.setEl('cmi.core.lesson_status', 'completed');\n            }\n\n            if (this.getEl('cmi.core.lesson_mode') == AddonModScormProvider.MODENORMAL) {\n                if (this.getEl('cmi.core.credit') == 'credit') {\n                    if (this.getEl('cmi.student_data.mastery_score') !== '' && this.getEl('cmi.core.score.raw') !== '') {\n                        if (parseFloat(this.getEl('cmi.core.score.raw')) >=\n                                parseFloat(this.getEl('cmi.student_data.mastery_score'))) {\n                            this.setEl('cmi.core.lesson_status', 'passed');\n                        } else {\n                            this.setEl('cmi.core.lesson_status', 'failed');\n                        }\n                    }\n                }\n            }\n\n            if (this.getEl('cmi.core.lesson_mode') == AddonModScormProvider.MODEBROWSE) {\n                if (this.dataModel[this.scoId]['cmi.core.lesson_status'].defaultvalue == '' &&\n                        this.getEl('cmi.core.lesson_status') == 'not attempted') {\n                    this.setEl('cmi.core.lesson_status', 'browsed');\n                }\n            }\n\n            tracks = this.collectData();\n            tracks.push(this.totalTime());\n        } else {\n            tracks = this.collectData();\n        }\n\n        const success = this.scormProvider.saveTracksSync(this.scoId, this.attempt, tracks, this.scorm, this.offline,\n                this.currentUserData);\n\n        if (!this.offline && !success) {\n            // Failure storing data in online. Go offline.\n            this.offline = true;\n\n            this.triggerEvent(AddonModScormProvider.GO_OFFLINE_EVENT);\n\n            return this.scormProvider.saveTracksSync(this.scoId, this.attempt, tracks, this.scorm, this.offline,\n                    this.currentUserData);\n        }\n\n        return success;\n    }\n\n    /**\n     * Utility function for calculating the total time spent in the SCO.\n     *\n     * @return {any} Total time element.\n     */\n    protected totalTime(): any {\n        const totalTime = this.addTime(this.getEl('cmi.core.total_time'), this.getEl('cmi.core.session_time'));\n\n        return { element: 'cmi.core.total_time', value: totalTime };\n    }\n\n    /**\n     * Convenience function to trigger events.\n     *\n     * @param {string} name Name of the event to trigger.\n     */\n    protected triggerEvent(name: string): void {\n        this.eventsProvider.trigger(name, {\n            scormId: this.scorm.id,\n            scoId: this.scoId,\n            attempt: this.attempt\n        }, this.siteId);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/scorm/classes/data-model-12.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { NavParams, PopoverController } from 'ionic-angular';\nimport { CoreEventsProvider } from '@providers/events';\nimport { CoreSitesProvider } from '@providers/sites';\nimport { CoreSyncProvider } from '@providers/sync';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreTimeUtilsProvider } from '@providers/utils/time';\nimport { AddonModScormProvider, AddonModScormAttemptCountResult } from '../../providers/scorm';\nimport { AddonModScormHelperProvider } from '../../providers/helper';\nimport { AddonModScormSyncProvider } from '../../providers/scorm-sync';\nimport { AddonModScormDataModel12 } from '../../classes/data-model-12';\nimport { AddonModScormTocPopoverComponent } from '../../components/toc-popover/toc-popover';\n\n/**\n * Page that allows playing a SCORM.\n */\n\n@Component({\n    selector: 'page-addon-mod-scorm-player',\n    templateUrl: 'player.html',\n})\nexport class AddonModScormPlayerPage implements OnInit, OnDestroy {\n\n    title: string; // Title.\n    scorm: any; // The SCORM object.\n    showToc: boolean; // Whether to show the table of contents (TOC).\n    loadingToc = true; // Whether the TOC is being loaded.\n    toc: any[]; // List of SCOs.\n    loaded: boolean; // Whether the data has been loaded.\n    previousSco: any; // Previous SCO.\n    nextSco: any; // Next SCO.\n    src: string; // Iframe src.\n    errorMessage: string; // Error message.\n\n    protected siteId: string;\n    protected mode: string; // Mode to play the SCORM.\n    protected newAttempt: boolean; // Whether to start a new attempt.\n    protected organizationId: string; // Organization ID to load.\n    protected attempt: number; // The attempt number.\n    protected offline = false; // Whether it's offline mode.\n    protected userData: any; // User data.\n    protected initialScoId: number; // Initial SCO ID to load.\n    protected currentSco: any; // Current SCO.\n    protected dataModel: AddonModScormDataModel12; // Data Model.\n    protected attemptToContinue: number; // Attempt to continue (for the popover).\n\n    // Observers.\n    protected tocObserver: any;\n    protected launchNextObserver: any;\n    protected launchPrevObserver: any;\n    protected goOfflineObserver: any;\n\n    constructor(navParams: NavParams, protected popoverCtrl: PopoverController, protected eventsProvider: CoreEventsProvider,\n            protected sitesProvider: CoreSitesProvider, protected syncProvider: CoreSyncProvider,\n            protected domUtils: CoreDomUtilsProvider, protected timeUtils: CoreTimeUtilsProvider,\n            protected scormProvider: AddonModScormProvider, protected scormHelper: AddonModScormHelperProvider,\n            protected scormSyncProvider: AddonModScormSyncProvider) {\n\n        this.scorm = navParams.get('scorm') || {};\n        this.mode = navParams.get('mode') || AddonModScormProvider.MODENORMAL;\n        this.newAttempt = !!navParams.get('newAttempt');\n        this.organizationId = navParams.get('organizationId');\n        this.initialScoId = navParams.get('scoId');\n        this.siteId = this.sitesProvider.getCurrentSiteId();\n\n        // We use SCORM name at start, later we'll use the SCO title.\n        this.title = this.scorm.name;\n\n        // Block the SCORM so it cannot be synchronized.\n        this.syncProvider.blockOperation(AddonModScormProvider.COMPONENT, this.scorm.id, 'player');\n    }\n\n    /**\n     * Component being initialized.\n     */\n    ngOnInit(): void {\n\n        this.showToc = this.scormProvider.displayTocInPlayer(this.scorm);\n\n        if (this.scorm.popup) {\n            // If we receive a value <= 100 we need to assume it's a percentage.\n            if (this.scorm.width <= 100) {\n                this.scorm.width = this.scorm.width + '%';\n            }\n            if (this.scorm.height <= 100) {\n                this.scorm.height = this.scorm.height + '%';\n            }\n        }\n\n        // Fetch the SCORM data.\n        this.fetchData().then(() => {\n            if (this.currentSco) {\n                // Set start time if it's a new attempt.\n                const promise = this.newAttempt ? this.setStartTime(this.currentSco.id) : Promise.resolve();\n\n                return promise.catch((error) => {\n                    this.domUtils.showErrorModalDefault(error, 'addon.mod_scorm.errorgetscorm', true);\n                }).finally(() => {\n                    // Load SCO.\n                    this.loadSco(this.currentSco);\n                });\n            }\n        }).finally(() => {\n            this.loaded = true;\n        });\n\n        // Listen for events to update the TOC, navigate through SCOs and go offline.\n        this.tocObserver = this.eventsProvider.on(AddonModScormProvider.UPDATE_TOC_EVENT, (data) => {\n            if (data.scormId === this.scorm.id) {\n                if (this.offline) {\n                    // Wait a bit to make sure data is stored.\n                    setTimeout(this.refreshToc.bind(this), 100);\n                } else {\n                    this.refreshToc();\n                }\n            }\n        }, this.siteId);\n\n        this.launchNextObserver = this.eventsProvider.on(AddonModScormProvider.LAUNCH_NEXT_SCO_EVENT, (data) => {\n            if (data.scormId === this.scorm.id && this.nextSco) {\n                this.loadSco(this.nextSco);\n            }\n        }, this.siteId);\n\n        this.launchPrevObserver = this.eventsProvider.on(AddonModScormProvider.LAUNCH_PREV_SCO_EVENT, (data) => {\n            if (data.scormId === this.scorm.id && this.previousSco) {\n                this.loadSco(this.previousSco);\n            }\n        }, this.siteId);\n\n        this.goOfflineObserver = this.eventsProvider.on(AddonModScormProvider.GO_OFFLINE_EVENT, (data) => {\n            if (data.scormId === this.scorm.id && !this.offline) {\n                this.offline = true;\n\n                // Wait a bit to prevent collisions between this store and SCORM API's store.\n                setTimeout(() => {\n                    this.scormHelper.convertAttemptToOffline(this.scorm, this.attempt).catch((error) => {\n                        this.domUtils.showErrorModalDefault(error, 'core.error', true);\n                    }).then(() => {\n                        this.refreshToc();\n                    });\n                }, 200);\n            }\n        }, this.siteId);\n    }\n\n    /**\n     * Calculate the next and previous SCO.\n     *\n     * @param {number} scoId Current SCO ID.\n     */\n    protected calculateNextAndPreviousSco(scoId: number): void {\n        this.previousSco = this.scormHelper.getPreviousScoFromToc(this.toc, scoId);\n        this.nextSco = this.scormHelper.getNextScoFromToc(this.toc, scoId);\n    }\n\n    /**\n     * Determine the attempt to use, the mode (normal/preview) and if it's offline or online.\n     *\n     * @param {AddonModScormAttemptCountResult} attemptsData Attempts count.\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected determineAttemptAndMode(attemptsData: AddonModScormAttemptCountResult): Promise<any> {\n        let result;\n\n        return this.scormHelper.determineAttemptToContinue(this.scorm, attemptsData).then((data) => {\n            this.attempt = data.number;\n            this.offline = data.offline;\n\n            if (this.attempt != attemptsData.lastAttempt.number) {\n                this.attemptToContinue = this.attempt;\n            }\n\n            // Check if current attempt is incomplete.\n            if (this.attempt > 0) {\n                return this.scormProvider.isAttemptIncomplete(this.scorm.id, this.attempt, this.offline);\n            } else {\n                // User doesn't have attempts. Last attempt is not incomplete (since he doesn't have any).\n                return false;\n            }\n        }).then((incomplete) => {\n            // Determine mode and attempt to use.\n            result = this.scormProvider.determineAttemptAndMode(this.scorm, this.mode, this.attempt, this.newAttempt, incomplete);\n\n            if (result.attempt > this.attempt) {\n                // We're creating a new attempt.\n                if (this.offline) {\n                    // Last attempt was offline, so we'll create a new offline attempt.\n                    return this.scormHelper.createOfflineAttempt(this.scorm, result.attempt, attemptsData.online.length);\n                } else {\n                    // Last attempt was online, verify that we can create a new online attempt. We ignore cache.\n                    return this.scormProvider.getScormUserData(this.scorm.id, result.attempt, undefined, false, true).catch(() => {\n                        // Cannot communicate with the server, create an offline attempt.\n                        this.offline = true;\n\n                        return this.scormHelper.createOfflineAttempt(this.scorm, result.attempt, attemptsData.online.length);\n                    });\n                }\n            }\n        }).then(() => {\n            this.mode = result.mode;\n            this.newAttempt = result.newAttempt;\n            this.attempt = result.attempt;\n        });\n    }\n\n    /**\n     * Fetch data needed to play the SCORM.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected fetchData(): Promise<any> {\n        // Wait for any ongoing sync to finish. We won't sync a SCORM while it's being played.\n        return this.scormSyncProvider.waitForSync(this.scorm.id).then(() => {\n            // Get attempts data.\n            return this.scormProvider.getAttemptCount(this.scorm.id).then((attemptsData) => {\n                return this.determineAttemptAndMode(attemptsData).then(() => {\n                    // Fetch TOC and get user data.\n                    const promises = [];\n\n                    promises.push(this.fetchToc());\n                    promises.push(this.scormProvider.getScormUserData(this.scorm.id, this.attempt, undefined, this.offline)\n                            .then((data) => {\n                        this.userData = data;\n                    }));\n\n                    return Promise.all(promises);\n                });\n            }).catch((error) => {\n                this.domUtils.showErrorModalDefault(error, 'addon.mod_scorm.errorgetscorm', true);\n            });\n        });\n    }\n\n    /**\n     * Fetch the TOC.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected fetchToc(): Promise<any> {\n        this.loadingToc = true;\n\n        // We need to check incomplete again: attempt number or status might have changed.\n        return this.scormProvider.isAttemptIncomplete(this.scorm.id, this.attempt, this.offline).then((incomplete) => {\n            this.scorm.incomplete = incomplete;\n\n            // Get TOC.\n            return this.scormProvider.getOrganizationToc(this.scorm.id, this.attempt, this.organizationId, this.offline);\n        }).then((toc) => {\n            this.toc = this.scormProvider.formatTocToArray(toc);\n\n            // Get images for each SCO.\n            this.toc.forEach((sco) => {\n                sco.image = this.scormProvider.getScoStatusIcon(sco, this.scorm.incomplete);\n            });\n\n            // Determine current SCO if we received an ID..\n            if (this.initialScoId > 0) {\n                // SCO set by parameter, get it from TOC.\n                this.currentSco = this.scormHelper.getScoFromToc(this.toc, this.initialScoId);\n            }\n\n            if (!this.currentSco) {\n                // No SCO defined. Get the first valid one.\n                return this.scormHelper.getFirstSco(this.scorm.id, this.attempt, this.toc, this.organizationId, this.offline)\n                        .then((sco) => {\n\n                    if (sco) {\n                        this.currentSco = sco;\n                    } else {\n                        // We couldn't find a SCO to load: they're all inactive or without launch URL.\n                        this.errorMessage = 'addon.mod_scorm.errornovalidsco';\n                    }\n                });\n            }\n        }).finally(() => {\n            this.loadingToc = false;\n        });\n    }\n\n    /**\n     * Page will leave.\n     */\n    ionViewWillUnload(): void {\n        // Empty src when leaving the state so unload event is triggered in the iframe.\n        this.src = '';\n    }\n\n    /**\n     * Load a SCO.\n     *\n     * @param {any} sco The SCO to load.\n     */\n    protected loadSco(sco: any): void {\n        if (!this.dataModel) {\n            // Create the model.\n            this.dataModel = new AddonModScormDataModel12(this.eventsProvider, this.scormProvider, this.siteId, this.scorm, sco.id,\n                    this.attempt, this.userData, this.mode, this.offline);\n\n            // Add the model to the window so the SCORM can access it.\n            (<any> window).API = this.dataModel;\n        } else {\n            // Load the SCO in the existing model.\n            this.dataModel.loadSco(sco.id);\n        }\n\n        this.currentSco = sco;\n        this.title = sco.title || this.scorm.name; // Try to use SCO title.\n\n        this.calculateNextAndPreviousSco(sco.id);\n\n        // Load the SCO source.\n        this.scormProvider.getScoSrc(this.scorm, sco).then((src) => {\n            if (src == this.src) {\n                // Re-loading same page. Set it to empty and then re-set the src in the next digest so it detects it has changed.\n                this.src = '';\n\n                setTimeout(() => {\n                    this.src = src;\n                });\n            } else {\n                this.src = src;\n            }\n        });\n\n        if (sco.scormtype == 'asset') {\n            // Mark the asset as completed.\n            const tracks = [{\n                element: 'cmi.core.lesson_status',\n                value: 'completed'\n            }];\n\n            this.scormProvider.saveTracks(sco.id, this.attempt, tracks, this.scorm, this.offline).catch(() => {\n                // Error saving data. We'll go offline if we're online and the asset is not marked as completed already.\n                if (!this.offline) {\n                    return this.scormProvider.getScormUserData(this.scorm.id, this.attempt, undefined, false).then((data) => {\n                        if (!data[sco.id] || data[sco.id].userdata['cmi.core.lesson_status'] != 'completed') {\n                            // Go offline.\n                            return this.scormHelper.convertAttemptToOffline(this.scorm, this.attempt).then(() => {\n                                this.offline = true;\n                                this.dataModel.setOffline(true);\n\n                                return this.scormProvider.saveTracks(sco.id, this.attempt, tracks, this.scorm, true);\n                            }).catch((error) => {\n                                this.domUtils.showErrorModalDefault(error, 'core.error', true);\n                            });\n                        }\n                    });\n                }\n            }).then(() => {\n                // Refresh TOC, some prerequisites might have changed.\n                this.refreshToc();\n            });\n        }\n\n        // Trigger SCO launch event.\n        this.scormProvider.logLaunchSco(this.scorm.id, sco.id).catch(() => {\n            // Ignore errors.\n        });\n    }\n\n    /**\n     * Show the TOC.\n     *\n     * @param {MouseEvent} event Event.\n     */\n    openToc(event: MouseEvent): void {\n        const popover = this.popoverCtrl.create(AddonModScormTocPopoverComponent, {\n            toc: this.toc,\n            attemptToContinue: this.attemptToContinue,\n            mode: this.mode\n        });\n\n        // If the popover sends back a SCO, load it.\n        popover.onDidDismiss((sco) => {\n            if (sco) {\n                this.loadSco(sco);\n            }\n        });\n\n        popover.present({\n            ev: event\n        });\n    }\n\n    /**\n     * Refresh the TOC.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected refreshToc(): Promise<any> {\n        return this.scormProvider.invalidateAllScormData(this.scorm.id).catch(() => {\n            // Ignore errors.\n        }).then(() => {\n            return this.fetchToc();\n        }).catch((error) => {\n            this.domUtils.showErrorModalDefault(error, 'addon.mod_scorm.errorgetscorm', true);\n        });\n    }\n\n    /**\n     * Set SCORM start time.\n     *\n     * @param {number} scoId SCO ID.\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected setStartTime(scoId: number): Promise<any> {\n        const tracks = [{\n            element: 'x.start.time',\n            value: this.timeUtils.timestamp()\n        }];\n\n        return this.scormProvider.saveTracks(scoId, this.attempt, tracks, this.scorm, this.offline).then(() => {\n            if (!this.offline) {\n                // New online attempt created, update cached data about online attempts.\n                this.scormProvider.getAttemptCount(this.scorm.id, false, true).catch(() => {\n                    // Ignore errors.\n                });\n            }\n        });\n    }\n\n    /**\n     * Component being destroyed.\n     */\n    ngOnDestroy(): void {\n        // Stop listening for events.\n        this.tocObserver && this.tocObserver.off();\n        this.launchNextObserver && this.launchNextObserver.off();\n        this.launchPrevObserver && this.launchPrevObserver.off();\n        this.goOfflineObserver && this.goOfflineObserver.off();\n\n        // Unblock the SCORM so it can be synced.\n        this.syncProvider.unblockOperation(AddonModScormProvider.COMPONENT, this.scorm.id, 'player');\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/scorm/pages/player/player.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { AddonModScormPlayerPage } from './player';\n\n@NgModule({\n    declarations: [\n        AddonModScormPlayerPage,\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        IonicPageModule.forChild(AddonModScormPlayerPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class AddonModScormPlayerPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/scorm/pages/player/player.module.ts","/**\n * @fileoverview This file was generated by the Angular template compiler. Do not edit.\n *\n * @suppress {suspiciousCode,uselessCode,missingProperties,missingOverride,checkTypes}\n * tslint:disable\n */ \nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./player.module\";\nimport * as i2 from \"../../../../../../node_modules/ionic-angular/components/action-sheet/action-sheet-component.ngfactory\";\nimport * as i3 from \"../../../../../../node_modules/ionic-angular/components/alert/alert-component.ngfactory\";\nimport * as i4 from \"../../../../../../node_modules/ionic-angular/components/app/app-root.ngfactory\";\nimport * as i5 from \"../../../../../../node_modules/ionic-angular/components/loading/loading-component.ngfactory\";\nimport * as i6 from \"../../../../../../node_modules/ionic-angular/components/modal/modal-component.ngfactory\";\nimport * as i7 from \"../../../../../../node_modules/ionic-angular/components/picker/picker-component.ngfactory\";\nimport * as i8 from \"../../../../../../node_modules/ionic-angular/components/popover/popover-component.ngfactory\";\nimport * as i9 from \"../../../../../../node_modules/ionic-angular/components/select/select-popover-component.ngfactory\";\nimport * as i10 from \"../../../../../../node_modules/ionic-angular/components/toast/toast-component.ngfactory\";\nimport * as i11 from \"../../../../../components/context-menu/context-menu-popover.ngfactory\";\nimport * as i12 from \"../../../../../components/course-picker-menu/course-picker-menu-popover.ngfactory\";\nimport * as i13 from \"../../../../../components/recaptcha/recaptchamodal.ngfactory\";\nimport * as i14 from \"./player.ngfactory\";\nimport * as i15 from \"@angular/common\";\nimport * as i16 from \"@angular/forms\";\nimport * as i17 from \"@ngx-translate/core/src/translate.loader\";\nimport * as i18 from \"@ngx-translate/core/src/translate.compiler\";\nimport * as i19 from \"@ngx-translate/core/src/translate.parser\";\nimport * as i20 from \"@ngx-translate/core/src/missing-translation-handler\";\nimport * as i21 from \"@ngx-translate/core/src/translate.service\";\nimport * as i22 from \"@ngx-translate/core/src/translate.store\";\nimport * as i23 from \"ionic-angular/module\";\nimport * as i24 from \"@ngx-translate/core/index\";\nimport * as i25 from \"../../../../../directives/directives.module\";\nimport * as i26 from \"../../../../../pipes/pipes.module\";\nimport * as i27 from \"../../../../../components/components.module\";\nimport * as i28 from \"ionic-angular/util/module-loader\";\nimport * as i29 from \"./player\";\nvar AddonModScormPlayerPageModuleNgFactory = i0.ɵcmf(i1.AddonModScormPlayerPageModule, [], function (_l) { return i0.ɵmod([i0.ɵmpd(512, i0.ComponentFactoryResolver, i0.ɵCodegenComponentFactoryResolver, [[8, [i2.ActionSheetCmpNgFactory, i3.AlertCmpNgFactory, i4.IonicAppNgFactory, i5.LoadingCmpNgFactory, i6.ModalCmpNgFactory, i7.PickerCmpNgFactory, i8.PopoverCmpNgFactory, i9.SelectPopoverNgFactory, i10.ToastCmpNgFactory, i11.CoreContextMenuPopoverComponentNgFactory, i12.CoreCoursePickerMenuPopoverComponentNgFactory, i13.CoreRecaptchaModalComponentNgFactory, i14.AddonModScormPlayerPageNgFactory]], [3, i0.ComponentFactoryResolver], i0.NgModuleRef]), i0.ɵmpd(4608, i15.NgLocalization, i15.NgLocaleLocalization, [i0.LOCALE_ID, [2, i15.ɵa]]), i0.ɵmpd(4608, i16.ɵi, i16.ɵi, []), i0.ɵmpd(4608, i16.FormBuilder, i16.FormBuilder, []), i0.ɵmpd(4608, i17.TranslateLoader, i17.TranslateFakeLoader, []), i0.ɵmpd(4608, i18.TranslateCompiler, i18.TranslateFakeCompiler, []), i0.ɵmpd(4608, i19.TranslateParser, i19.TranslateDefaultParser, []), i0.ɵmpd(4608, i20.MissingTranslationHandler, i20.FakeMissingTranslationHandler, []), i0.ɵmpd(4608, i21.TranslateService, i21.TranslateService, [i22.TranslateStore, i17.TranslateLoader, i18.TranslateCompiler, i19.TranslateParser, i20.MissingTranslationHandler, i21.USE_DEFAULT_LANG, i21.USE_STORE]), i0.ɵmpd(512, i15.CommonModule, i15.CommonModule, []), i0.ɵmpd(512, i16.ɵba, i16.ɵba, []), i0.ɵmpd(512, i16.FormsModule, i16.FormsModule, []), i0.ɵmpd(512, i16.ReactiveFormsModule, i16.ReactiveFormsModule, []), i0.ɵmpd(512, i23.IonicModule, i23.IonicModule, []), i0.ɵmpd(512, i24.TranslateModule, i24.TranslateModule, []), i0.ɵmpd(512, i25.CoreDirectivesModule, i25.CoreDirectivesModule, []), i0.ɵmpd(512, i26.CorePipesModule, i26.CorePipesModule, []), i0.ɵmpd(512, i27.CoreComponentsModule, i27.CoreComponentsModule, []), i0.ɵmpd(512, i23.IonicPageModule, i23.IonicPageModule, []), i0.ɵmpd(512, i1.AddonModScormPlayerPageModule, i1.AddonModScormPlayerPageModule, []), i0.ɵmpd(256, i21.USE_STORE, undefined, []), i0.ɵmpd(256, i21.USE_DEFAULT_LANG, undefined, []), i0.ɵmpd(256, i28.LAZY_LOADED_TOKEN, i29.AddonModScormPlayerPage, [])]); });\nexport { AddonModScormPlayerPageModuleNgFactory as AddonModScormPlayerPageModuleNgFactory };\n//# sourceMappingURL=player.module.ngfactory.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/scorm/pages/player/player.module.ngfactory.js.pre-build-optimizer.js"]}